CREATE TABLE "Event" (
	"ev_id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"ev_name" VARCHAR(30) NOT NULL,
	"ev_description" TEXT,
	"ev_date" TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
	"org_id" INTEGER NOT NULL,
	"loc_id" INTEGER NOT NULL,
	"cat_id" INTEGER NOT NULL,
	PRIMARY KEY("ev_id")
);
CREATE INDEX "Event_index_0"
ON "Event" ("ev_name");

CREATE TABLE "Location" (
	"loc_id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"loc_name" VARCHAR(30) NOT NULL,
	"loc_address" TEXT NOT NULL,
	"loc_capacity" INTEGER NOT NULL,
	PRIMARY KEY("loc_id")
);

CREATE TABLE "Sponsor" (
	"sp_id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"sp_name" VARCHAR(255) NOT NULL,
	"sp_phone" BIGINT NOT NULL,
	PRIMARY KEY("sp_id")
);

CREATE TABLE "Category" (
	"cat_id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"cat_name" VARCHAR(30) NOT NULL,
	"cat_description" TEXT,
	PRIMARY KEY("cat_id")
);

CREATE TABLE "Ticket" (
	"tick_id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"tick_price" DECIMAL(10,2) NOT NULL,
	"tick_available_quantity" INTEGER NOT NULL,
	"id_event" INTEGER NOT NULL,
	"tyt_id" INTEGER NOT NULL,
	PRIMARY KEY("tick_id")
);

CREATE TABLE "Event_Sponsor" (
	"ev_es_id" INTEGER NOT NULL,
	"sp_id" INTEGER NOT NULL,
	"ev_id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	PRIMARY KEY("ev_es_id", "sp_id", "ev_id")
);

CREATE TABLE "User" (
	"us_id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"us_name" VARCHAR(255) NOT NULL,
	"us_phone" BIGINT,
	PRIMARY KEY("us_id")
);

CREATE TABLE "User_Event" (
	"us_ev_id" INTEGER NOT NULL,
	"ev_id" INTEGER NOT NULL,
	"us_id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	PRIMARY KEY("us_ev_id", "ev_id", "us_id")
);

CREATE TABLE "Organizer" (
	"org_id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"org_name" VARCHAR(255) NOT NULL,
	"org_phone" BIGINT NOT NULL,
	PRIMARY KEY("org_id")
);

CREATE TABLE "TypeTicket" (
	"tyt_id" INTEGER NOT NULL UNIQUE GENERATED BY DEFAULT AS IDENTITY,
	"tyt_name" VARCHAR(30) NOT NULL,
	"tyt_price" DECIMAL(10,2) NOT NULL,
	PRIMARY KEY("tyt_id")
);

ALTER TABLE "Event"
ADD FOREIGN KEY("org_id") REFERENCES "Organizer"("org_id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "Event"
ADD FOREIGN KEY("loc_id") REFERENCES "Location"("loc_id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "Sponsor"
ADD FOREIGN KEY("sp_id") REFERENCES "Event_Sponsor"("sp_id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "Event"
ADD FOREIGN KEY("ev_id") REFERENCES "Event_Sponsor"("ev_id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "Event"
ADD FOREIGN KEY("ev_id") REFERENCES "Ticket"("id_event")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "Event"
ADD FOREIGN KEY("ev_id") REFERENCES "User_Event"("ev_id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "User"
ADD FOREIGN KEY("us_id") REFERENCES "User_Event"("us_id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "Event"
ADD FOREIGN KEY("cat_id") REFERENCES "Category"("cat_id")
ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE "TypeTicket"
ADD FOREIGN KEY("tyt_id") REFERENCES "Ticket"("tyt_id")
ON UPDATE NO ACTION ON DELETE NO ACTION;